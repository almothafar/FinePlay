@import scala.collection.immutable._
@import scala.collection.immutable.Map
@import scala.collection.immutable.Seq
@import scala.collection.immutable.List
@import scala.collection.JavaConverters._
@import scala.collection.JavaConversions._

@import play.api.i18n._
@import play.api.inject._
@import play.api.Logger
@import play.filters.csrf._

@import models.system._
@import models.system.System._
@import models.user._
@import models.user.User._

@import views.html._

@import common.system._
@import common.utils._

@(currentSection:String, currentWork:String)(content: Html)

@isDev() = @{

	common.system.System.getInjector().instanceOf(classOf[play.api.Environment]).mode == play.api.Mode.Dev
}

@isShow(permissions:Permission*) = @{

	Logger.info("Menu");
	val roleValues = session().getOrDefault(User.ROLES, /* Direct access of not signin */"");
	models.system.System.isPermissionAllowed(EnumSet.copyOf(permissions.asJava), User.getPermissions(Sessions.toRoles(roleValues)))
}

@equalSection(section:String) = @{

	if(section.equals(currentSection)){
		"true"
	}else{
		"false"
	}
}

@equalWork(section:String, work:String) = @{

	if(section.equals(currentSection) && work.equals(currentWork)){
		"true"
	}else{
		"false"
	}
}

<body>

	@mode()

	@token()

	@theme()

	<div id="system_base">

		<div id="system_work-menu">

			@workmenu(Map("id"->"system_sections"), List(
				(Map("name"->Messages(MessageKeys.HOME), "icon"->"fa fa-home", "selected"->equalSection("home")),List(
					Map("name"->Messages(MessageKeys.INTRO), "icon"->"fa fa-file-text-o", "link"->controllers.home.routes.Home.index().toString(), "selected"->equalWork("home","intro")),
					Map("name"->Messages(MessageKeys.VIDEO), "icon"->"fa fa-film", "link"->controllers.home.routes.Home.video().toString(), "selected"->equalWork("home","video"))
				)),
				(Map("name"->Messages(MessageKeys.SETTING), "icon"->"fa fa-cog", "selected"->equalSection("setting")),List(
					Map("name"->Messages(MessageKeys.SYSTEM), "icon"->"fa fa-desktop", "link"->controllers.setting.system.routes.System.index().toString(), "selected"->equalWork("setting","system")),
					Map("name"->Messages(MessageKeys.USER), "icon"->"fa fa-user", "link"->controllers.setting.user.routes.User.index().toString(), "selected"->equalWork("setting","user"))
				)),
				(Map("name"->Messages(MessageKeys.INFORMATION), "icon"->"fa fa-info-circle", "selected"->equalSection("information")),List(
					Map("name"->Messages(MessageKeys.CREATOR), "icon"->"fa fa-address-card", "link"->controllers.information.routes.Information.creator().toString(), "selected"->equalWork("information","creator")),
					Map("name"->Messages(MessageKeys.LICENSE), "icon"->"ii ii-fineplay", "link"->controllers.information.routes.Information.license().toString(), "selected"->equalWork("information","license"))
				)),
				(Map("show"->isShow(Permission.MANAGE).toString(), "name"->Messages(MessageKeys.MANAGE), "icon"->"fa fa-wrench", "selected"->equalSection("manage")),List(
					Map("name"->Messages(MessageKeys.COMPANY), "icon"->"fa fa-building-o", "link"->controllers.manage.company.routes.Read.index().toString(), "selected"->equalWork("manage","company")),
					Map("name"->Messages(MessageKeys.USER), "icon"->"fa fa-user", "link"->controllers.manage.user.routes.Read.index().toString(), "selected"->equalWork("manage","user"))
				)),
				(Map("show"->isDev().toString(), "name"->Messages(MessageKeys.DEVELOPMENT), "icon"->"nf nf-disclosure_triangle", "selected"->equalSection("development")),List(
					Map("name"->Messages(MessageKeys.HTTP), "icon"->"fa fa-file-text-o", "link"->controllers.development.http.routes.Http.index("ajax").toString(), "selected"->equalWork("development","http")),
					Map("name"->Messages(MessageKeys.JAVASCRIPT), "icon"->"fa fa-file-text-o", "link"->controllers.development.javascript.routes.JavaScript.index("test").toString(), "selected"->equalWork("development","javascript")),
					Map("name"->Messages(MessageKeys.DESIGN), "icon"->"fa fa-object-group", "link"->controllers.development.design.routes.Design.index("theme").toString(), "selected"->equalWork("development","design")),
					Map("name"->Messages(MessageKeys.DOCUMENT), "icon"->"fa fa-file-text-o", "link"->controllers.development.document.routes.Document.index("troubleshoot").toString(), "selected"->equalWork("development","document")),
					Map("name"->Messages(MessageKeys.HELP), "icon"->"fa fa-question-circle-o", "link"->controllers.development.help.routes.Help.typography().toString(), "selected"->equalWork("development","help"))
				)),
				(Map("show"->isDev().toString(), "name"->Messages(MessageKeys.ENVIRONMENT), "icon"->"fa fa-thermometer-half", "selected"->equalSection("environment")),List(
					Map("name"->Messages(MessageKeys.JAVA), "icon"->"fa fa-coffee", "link"->controllers.environment.javalang.routes.Java.index().toString(), "selected"->equalWork("environment","java")),
					Map("name"->Messages(MessageKeys.BROWSER), "icon"->"fa fa-safari", "link"->controllers.environment.browser.routes.Browser.index().toString(), "selected"->equalWork("environment","browser"))
				)),
				(Map("show"->isDev().toString(), "name"->Messages(MessageKeys.FRAMEWORK), "icon"->"ii ii-play if-monochrome", "selected"->equalSection("framework")),List(
					Map("name"->Messages(MessageKeys.WELCOME), "icon"->"ii ii-play", "link"->controllers.framework.welcome.routes.Welcome.index().toString(), "selected"->equalWork("framework","welcome")),
					Map("name"->(Messages(MessageKeys.DEFAULT)+" "+Messages(MessageKeys.PAGE)), "icon"->"ef ef-note", "link"->controllers.framework.defaultpage.routes.Defaultpage.index().toString(), "selected"->equalWork("framework","defaultpage")),
					Map("name"->Messages(MessageKeys.APPLICATION), "icon"->"ef ef-musical_note if-monochrome if-inverse", "link"->controllers.framework.application.routes.Application.index("config").toString(), "selected"->equalWork("framework","application")),
					Map("name"->Messages(MessageKeys.DATETIME), "icon"->"ef ef-calendar if-monochrome", "link"->controllers.framework.datetime.routes.DateTime.index().toString(), "selected"->equalWork("framework","datetime"))
				)),
				(Map("show"->isDev().toString(), "name"->Messages(MessageKeys.BOOTSTRAP), "icon"->"ii ii-bootstrap if-monochrome if-inverse", "selected"->equalSection("bootstrap")),List(
					Map("name"->Messages(MessageKeys.COMPONENT), "icon"->"fa fa-file-text-o", "link"->controllers.bootstrap.component.routes.Component.index("button").toString(), "selected"->equalWork("bootstrap","component")),
					Map("name"->Messages(MessageKeys.LAYOUT), "icon"->"fa fa-file-text-o", "link"->controllers.bootstrap.layout.routes.Layout.index("responsive").toString(), "selected"->equalWork("bootstrap","layout")),
					Map("name"->"I Like", "icon"->"fa fa-file-text-o", "link"->controllers.bootstrap.ilike.routes.ILike.index().toString(), "selected"->equalWork("bootstrap","ilike"))
				)),
				(Map("show"->isDev().toString(), "name"->Messages(MessageKeys.FONTAWESOME), "icon"->"fa fa-font-awesome", "selected"->equalSection("fontawesome")),List(
					Map("name"->Messages(MessageKeys.STYLE), "icon"->"fa fa-file-text-o", "link"->controllers.fontawesome.style.routes.Style.index("squareicon").toString(), "selected"->equalWork("fontawesome","style"))
				)),
				(Map("show"->isDev().toString(), "name"->Messages(MessageKeys.LAB), "icon"->"fa fa-flask", "selected"->equalSection("lab")),List(
					Map("name"->Messages(MessageKeys.LIBRARY), "icon"->"fa fa-file-text-o", "link"->controllers.lab.library.routes.Library.index("bootbox").toString(), "selected"->equalWork("lab","library")),
					Map("name"->Messages(MessageKeys.APPLICATION), "icon"->"fa fa-file-text-o", "link"->controllers.lab.application.routes.Download.index().toString(), "selected"->equalWork("lab","application")),
					Map("name"->Messages(MessageKeys.UI), "icon"->"fa fa-file-text-o", "link"->controllers.lab.ui.routes.UI.index("drawer").toString(), "selected"->equalWork("lab","ui")),
					Map("name"->Messages(MessageKeys.MAINTENANCE), "icon"->"fa fa-file-text-o", "link"->controllers.lab.maintenance.routes.Maintenance.master().toString(), "selected"->equalWork("lab","maintenance"))
				)),
				(Map("show"->isDev().toString(), "name"->Messages(MessageKeys.SECTION), "icon"->"fa fa-folder-o", "selected"->equalSection("section")),List(
					Map("name"->Messages(MessageKeys.WORK), "icon"->"fa fa-file-text-o", "link"->controllers.section.work.routes.Work.task().toString, "selected"->equalWork("section","work")),
					Map("name"->(Messages(MessageKeys.WORK)+" 2"), "icon"->"fa fa-file-text-o", "link"->"", "selected"->equalWork("section","work2")),
					Map("name"->(Messages(MessageKeys.WORK)+" 3"), "icon"->"fa fa-file-text-o", "link"->"", "selected"->equalWork("section","work3"), "enabled"->"false")
				))
			))
		</div>

		<button id="system_menu-left-corner">
		</button>

		<nav id="system_menu" class="navbar navbar-expand-xs navbar-light bg-light md-3 shadow">

			<div class="d-inline">
			@components.button(Map("id"->"menuButton", "type"->"link", "icon"->"navbar-toggler-icon", "text"->"", "class"->"navbar-toggler", "aria-expanded"->"false", "aria-label"->"Toggle navigation"))
			<a class="navbar-brand d-none d-md-inline ml-1 mt-1" href="@controllers.home.routes.Home.index()">
				@components.image(Map("id"->"system_logo", "source"->routes.Assets.versioned("images/" + lang.code + "/logo.png").toString, "alternate"->"System logo."))
			</a>
			</div>
			<div class="" id="">
				<ul class="navbar-nav mr-auto">
				</ul>
				<form class="form-inline float-right align-items-center">
					@views.html.debug()
					@components.button(Map("id"->"printButton", "type"->"link", "icon"->"fa fa-print", "text"->"", "class"->"ml-1 d-none"))
					@components.button(Map("id"->"scrollTopButton", "type"->"link", "icon"->"fa fa-angle-double-up", "text"->"", "class"->"ml-1"))
					<div class="btn-group">
						<button id="system_user-menu" type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							<i class="fa fa-user"></i><span class="d-none d-sm-inline"> @session().get(User.USERID)</span>
						</button>
						<div class="dropdown-menu dropdown-menu-right">
							<a class="dropdown-item" href="@controllers.setting.user.routes.User.index()"><i class="fa fa-cog"></i> @Messages(MessageKeys.SETTING)...</a>
							<a id="signOutLink" class="dropdown-item" href="@controllers.user.routes.User.signOut()"><i class="fa fa-sign-out"></i> @Messages(MessageKeys.USER_SIGNOUT)</a>
						</div>
					</div>
					@components.button(Map("id"->"helpButton", "type"->"link", "icon"->"fa fa-question-circle-o", "text"->"", "class"->"ml-1 d-none"))
				</form>
			</div>
		</nav>

		<nav class="navbar invisible">
			@components.button(Map("type"->"link", "icon"->"navbar-toggler-icon"))
		</nav>

		<div id="system_extension-menu" class="shadow">
		</div>

		<div id="system_content">

			@content

			@components.container(Map("id"->"system_credit-container", "fluid"->"true", "class"->"text-center")){

				@components.credit()
			}
		</div>

		<div id="system_notifications">
		</div>

		@components.modal(Map("id"->"reportErrorDialog", "icon"->"fa fa-bug", "title"->(Messages(MessageKeys.REPORT)+" "+Messages(MessageKeys.ERROR)), "data-backdrop"->"static", "size"->"lg"), List(
				Map("id"->"reportErrorCancel", "type"->"primary", "outline"->"true", "text"->Messages(MessageKeys.CANCEL), "data-dismiss"->"modal"),
				Map("id"->"reportErrorButton", "type"->"primary", "text"->Messages(MessageKeys.REPORT), "default"->"true")
			)){
			<textarea id="reportErrorContent" class="form-control" placeholder="Content" rows="16" required maxlength="1000"></textarea>
			<div class="wordwrap">
				<div id="reportErrorMessage" class="lead"></div>
				<div id="reportErrorDescription">-</div>
			</div>
			@components.progress(Map("id"->"reportErrorProgress", "value"->"0", "max"->"100", "striped"->"true", "animated"->"true"))
			@if(isDev()){
			<div class="mt-3">
				<input type="text" class="form-control" id="searchErrorMessage" placeholder="@Messages(MessageKeys.ERROR)">
				@components.button(Map("id"->"searchStackOverflowButton", "type"->"primary", "outline"->"true", "icon"->"fa fa-stack-overflow", "text"->"Stack Overflow"))
				@components.button(Map("id"->"searchStackOverflowJaButton", "type"->"primary", "outline"->"true", "icon"->"fa fa-stack-overflow", "text"->"スタック・オーバーフロー"))
				@components.button(Map("id"->"searchQiitaButton", "type"->"primary", "outline"->"true", "icon"->"", "text"->"Qiita"))
				@components.button(Map("id"->"searchTeratailButton", "type"->"primary", "outline"->"true", "icon"->"", "text"->"teratail"))
			</div>
			}
		}

		<div id="system_help-base">

			<div id="system_help-header">

				<nav id="system_help-menu" class="navbar bg-primary d-flex justify-content-center">
					<div class="row align-items-center">
						@components.button(Map("type"->"link", "icon"->"navbar-toggler-icon", "text"->"", "class"->"navbar-toggler", "tabindex"->"-1"))
						<div class="h4 mb-0">@Messages(MessageKeys.HELP)</div>
						@components.button(Map("type"->"link", "icon"->"navbar-toggler-icon", "text"->"", "class"->"navbar-toggler", "tabindex"->"-1"))
					</div>
				</nav>

				@components.container(Map("id"->"", "fluid"->"true", "class"->"bg-light py-2")){
					<div class="input-group">
						<span class="input-group-addon">@components.icon(Map("id"->"", "icon"->"fa fa-search"))</span>
						<input id="help-search-text" type="text" class="form-control" aria-label="">
						<span id="help-search-clear" class="input-group-addon">@components.icon(Map("id"->"", "icon"->"fa fa-times-circle"))</span>
					</div>
				}

				<nav id="system_help-navbar" class="navbar navbar-light bg-light">

					@components.nav(Map("id"->"","pills"->"true"), List(
						/* Pair with help-top */
						Map("icon"->"fa fa-angle-double-up", "link"->"#help-top", "selected"->"true")
					))
				</nav>
			</div>

			<div id="system_help-content" class="help-notready">

				<div id="system_help-main" data-spy="scroll" data-target="#system_help-navbar" data-offset="0" class="shadow-inset">

					<!-- Pair with nav-link -->
					<h1 class="bd-title" id="help-top">
					</h1>

					<div class="d-flex h-100">
						<div class="align-self-center w-100">
							<div class="d-flex justify-content-center">
								<span class="fa-stack fa-2x rounded bg-secondary opacity-25">
									@components.icon(Map("id"->"system_help-content-loading", "icon"->"fa fa-spinner fa-pulse fa-stack-1x", "class"->"text-white"))
								</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>

	<div id="system_cover">
		<div class="row h-100 mx-3">
			<div class="col-5"></div>
			<div class="col-2 align-self-center">
				<div class="row justify-content-center">
					<div class="d-md-block rounded p-5 bg-secondary opacity-25">
						<i class="fa fa-circle-o-notch fa-5x fa-spin text-white"></i>
					</div>
				</div>
			</div>
			<div class="col-5"></div>
		</div>
	</div>

	<div id="system_magnify-text">
		<div class="row h-100 mx-3">
			<div class="col-12 align-self-center">
				<div class="row justify-content-center">
					<div class="d-md-block rounded px-3 m-3 bg-secondary opacity-75">
						<span id="system_magnify-text-content"></span>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="system_responsive-bar" class="w-100 d-none">

		<div class="progress">
			<div class="progress-bar text-left">&nbsp;XS 0px〜</div>
			<div class="progress-bar text-left bg-success">&nbsp;SM 576px〜</div>
			<div class="progress-bar text-left bg-info">&nbsp;MD 768px〜</div>
			<div class="progress-bar text-left bg-warning">&nbsp;LG 992px〜</div>
			<div class="progress-bar text-left bg-danger">&nbsp;XL 1200px〜</div>
		</div>
	</div>

	<div id="body_messages" class="d-none" data-messages='{
		"@MessageKeys.PLEASE__WAIT":"@Messages(MessageKeys.PLEASE__WAIT)",
		"@MessageKeys.FAILURE":"@Messages(MessageKeys.FAILURE)",
		"@MessageKeys.STATUS":"@Messages(MessageKeys.STATUS)",
		"@MessageKeys.ERROR":"@Messages(MessageKeys.ERROR)",
		"currentSection":"@currentSection",
		"currentWork":"@currentWork",
		"userId":"@session.get(models.user.User.USERID)",
		"getHelpError":"@Messages(MessageKeys.SYSTEM_ERROR_X_NOTEXIST, Messages(MessageKeys.HELP))"
	}'></div>

	<script src='@routes.Assets.versioned("javascripts/body.js")'></script>
</body>
