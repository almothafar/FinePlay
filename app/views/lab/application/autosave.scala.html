@import scala.collection.immutable._
@import scala.collection.immutable.Map
@import scala.collection.immutable.Seq
@import scala.collection.immutable.List
@import scala.collection.JavaConversions._
@import views.html._
@import views.html.components

@import common.system._

@()

@frame(){

	@head("lab"){

		@libraries.standard.head()
	}

	@body("lab","application"){

		@components.container(Map("id"->"", "fluid"->"true", "class"->"mt-3")){
			@breadcrumb(Map("id"->"", "name"->(Messages(MessageKeys.AUTO)+" "+Messages(MessageKeys.SAVE)), "icon"->"fa fa-pencil", "selected"->"true"))
		}

		@components.container(Map("id"->"", "fluid"->"true")){
			<div class="row">
				<div class="col-md-3">

					@tasks(Map("id"->"", "task"->"autosave"))
				</div>
				<div class="mt-3 d-md-none">
				</div>
				<div class="col-md-9">

					@components.alert(Map("id"->"permissionWarning", "icon"->"fa fa-exclamation-triangle", "text"->"", "type"->"warning", "closable"->"true"))

					@components.badge(Map("id"->"Notification", "type"->"danger", "text"->"Notification"))
					@components.badge(Map("id"->"LocalStorage", "type"->"danger", "text"->"LocalStorage"))

					<form id="inputArea">
						<div class="form-group row">
							<label for="data0" class="col-md-3 col-form-label">data0</label>
							<div class="col-md-9">
								<input id="data0" type="text" name="data0" class="form-control" placeholder="Data0" value="" autofocus>
							</div>
						</div>
						<div class="form-group row">
							<label for="data1" class="col-md-3 col-form-label">data1</label>
							<div class="col-md-9">
								<input id="data1" type="text" name="data1" class="form-control" placeholder="Data1" value="">
							</div>
						</div>
					</form>
				</div>
			</div>
		}

		@libraries.standard.last()
		@script(){

			$("#permissionWarning").append("<span></span>").hide();

			if(window.Notification){

				$("#Notification").removeClass("badge-danger").addClass("badge-success");

				if(window.localStorage){

					$("#LocalStorage").removeClass("badge-danger").addClass("badge-success");

					Forms.restore('#inputArea');
					Notification.requestPermission(function(permission){

						switch(permission){
							case "default":
							case "denied":

								$("#permissionWarning>span").html("<strong>Notification permission</strong> "+permission);
								$("#permissionWarning").show();
								break;
							case "granted":

								setInterval(function(){

									Forms.store('#inputArea');
									new Notification("Temporary saved", {});
								},5000)

								break;
						};
					});
				}
			}
		}
	}
}
