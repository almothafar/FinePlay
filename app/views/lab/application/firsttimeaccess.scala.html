@import models.components._
@import common.system._

@()

@import scala.collection.immutable._
@import scala.collection.immutable.Map
@import scala.collection.immutable.Seq
@import scala.collection.immutable.List
@import scala.collection.JavaConversions._
@import views.html._
@import views.html.components

@frame(){

	@head("lab"){

		@libraries.standard.head()
		@libraries.slick.head()
		@style(){

			/* Hide initialize */
			.slick-container>div>img{
				visibility: hidden;
			}
			#firstDialog .modal-body{
				height:400px;
				padding: 0;
			}
			.slick-prev{
				left: 25px;
				z-index: 1;
			}
			.slick-next{
				right: 25px;
				z-index: 1;
			}
			.slick-dots{
				bottom: 25px;
				z-index: 1;
			}
		}
	}

	@body("lab","application"){

		@components.container(Map("id"->"", "fluid"->"true", "class"->"mt-3")){
			@breadcrumb(Map("id"->"", "name"->(Messages(MessageKeys.FIRST__TIME)+" "+Messages(MessageKeys.ACCESS)), "icon"->"fa fa-handshake-o", "selected"->"true"))
		}

		@components.container(Map("id"->"", "fluid"->"true")){
			<div class="row">
				<div class="col-md-3">

					@tasks(Map("id"->"", "task"->"firsttimeaccess"))
				</div>
				<div class="mt-3 d-md-none">
				</div>
				<div class="col-md-9">

					@components.badge(Map("id"->"LocalStorage", "type"->"danger", "text"->"LocalStorage"))

					<div class="mb-3">

						@components.button(Map("id"->"resetButton", "type"->"primary", "outline"->"true", "text"->Messages(MessageKeys.RESET), "enabled"->"false"))
					</div>

					@components.modal(Map("id"->"firstDialog", "title"->"", "closable"->"true", "size"->"lg"), List(
							Map("id"->"start", "type"->"primary", "text"->Messages(MessageKeys.START), "data-dismiss"->"modal", "default"->"true")
						)){

						<div class="slick-container">
							<div>@components.image(Map("id"->"", "source"->"holder.js/100px400?random=yes", "fluid"->"true", "alternate"->"Slide 1"))</div>
							<div>@components.image(Map("id"->"", "source"->"holder.js/100px400?random=yes", "fluid"->"true", "alternate"->"Slide 2"))</div>
							<div>@components.image(Map("id"->"", "source"->"holder.js/100px400?random=yes", "fluid"->"true", "alternate"->"Slide 3"))</div>
							<div>@components.image(Map("id"->"", "source"->"holder.js/100px400?random=yes", "fluid"->"true", "alternate"->"Slide 4"))</div>
							<div>@components.image(Map("id"->"", "source"->"holder.js/100px400?random=yes", "fluid"->"true", "alternate"->"Slide 5"))</div>
						</div>
					}
				</div>
			</div>
		}

		@libraries.standard.last()
		@libraries.slick.last()
		@libraries.holder.last()
		@script(){

			var taskKey = "firstAccess";
			var documentId = "guided";

			if(window.localStorage){

				$("#LocalStorage").removeClass("badge-danger").addClass("badge-success");

				var savedDataJson = window.localStorage.getItem(taskKey);
				if(!savedDataJson){

					savedDataJson = JSON.stringify({})
					window.localStorage.setItem(taskKey, savedDataJson);
				}

				var savedData = JSON.parse(savedDataJson);
				var isGuided = savedData[documentId];

				if(!isGuided){

					$('#firstDialog').modal('show');

					$('#firstDialog').on('shown.bs.modal', function (e) {

						$('.slick-container').slick({
							dots: true
						});
					})

					savedData[documentId] = true;

					var saveDataJson = JSON.stringify(savedData);
					window.localStorage.setItem(taskKey, saveDataJson);
				}

				$('#resetButton').prop('disabled', false);

				$('#resetButton').on('click', function(){

					savedData[documentId] = false;
					var saveDataJson = JSON.stringify(savedData);
					window.localStorage.setItem(taskKey, saveDataJson);
				});
			}
		}
	}
}
